repos:
  - id: /.*/
    allowed_overrides: [workflow]
    pre_workflow_hooks:
      - run: "/usr/local/bin/generate-tfc-rc.sh; /usr/local/bin/generate-client-config.sh"

   
workflows:
  terraform:
    plan:
      steps:
      - name: Configure AWS credentials
        uses: aws-actions/configure-aws-credentials@v1
        with:
          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY }}
          aws-secret-access-key: ${{ secrets.AWS_SECRET_KEY }}
          aws-region: 'eu-central-1'
      - env:
          name: AWS_SECRET_KEY_ID
          command: 
      - env:
          name: AWS_SECRET_ACCESS_KEY
          command:
      - env:
          name: TF_WORKSPACE
          command: echo $WORKSPACE
      - init
      - plan:
          extra_args: ["-var-file=tfvars/$WORKSPACE.tfvars"]

